from nbclient import NotebookClient
import nbformat
from nbconvert.preprocessors import ExecutePreprocessor

def execute_notebook(notebook_path):
    with open(notebook_path) as f:
        nb = nbformat.read(f, as_version=4)

    client = NotebookClient(nb)
    ep = ExecutePreprocessor(timeout=600)
    ep.preprocess(nb, {'metadata': {'path': './'}})

    with open(notebook_path, 'w', encoding='utf-8') as f:
        nbformat.write(nb, f)

    return nb
    
    
t1=execute_notebook('./testauto.ipynb')
